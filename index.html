<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA対応 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="美容院管理">
    <meta name="theme-color" content="#2563eb">
    
    <title>美容院管理アプリ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            overscroll-behavior: none;
        }

        ::-webkit-scrollbar {
            display: none;
        }

        .touch-manipulation {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        input:focus, select:focus, textarea:focus, button:focus {
            outline: none;
        }

        button:active {
            transform: scale(0.98);
            transition: transform 0.1s;
        }

        input, select, textarea {
            -webkit-appearance: none;
            border-radius: 8px;
            font-size: 16px; /* iOS zoom prevention */
        }

        .modal-content {
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }

        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* iOS対応 */
        @supports (-webkit-touch-callout: none) {
            .ios-input {
                font-size: 16px !important;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo, useCallback, useEffect, useRef } = React;

        // アイコンコンポーネント
        const Search = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('circle', {cx: "11", cy: "11", r: "8"}),
            React.createElement('path', {d: "m21 21-4.35-4.35"})
        );
        
        const Plus = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "M5 12h14"}),
            React.createElement('path', {d: "M12 5v14"})
        );
        
        const User = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),
            React.createElement('circle', {cx: "12", cy: "7", r: "4"})
        );
        
        const Calendar = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('rect', {x: "3", y: "4", width: "18", height: "18", rx: "2", ry: "2"}),
            React.createElement('line', {x1: "16", y1: "2", x2: "16", y2: "6"}),
            React.createElement('line', {x1: "8", y1: "2", x2: "8", y2: "6"}),
            React.createElement('line', {x1: "3", y1: "10", x2: "21", y2: "10"})
        );
        
        const Scissors = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('circle', {cx: "6", cy: "6", r: "3"}),
            React.createElement('circle', {cx: "6", cy: "18", r: "3"}),
            React.createElement('line', {x1: "20", y1: "4", x2: "8.12", y2: "15.88"}),
            React.createElement('line', {x1: "14.47", y1: "14.48", x2: "20", y2: "20"}),
            React.createElement('line', {x1: "8.12", y1: "8.12", x2: "12", y2: "12"})
        );
        
        const Save = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),
            React.createElement('polyline', {points: "17,21 17,13 7,13 7,21"}),
            React.createElement('polyline', {points: "7,3 7,8 15,8"})
        );
        
        const X = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "M18 6 6 18"}),
            React.createElement('path', {d: "M6 6l12 12"})
        );
        
        const ChevronLeft = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "m15 18-6-6 6-6"})
        );
        
        const ChevronRight = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "m9 18 6-6-6-6"})
        );

        const Trash2 = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('polyline', {points: "3,6 5,6 21,6"}),
            React.createElement('path', {d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),
            React.createElement('line', {x1: "10", y1: "11", x2: "10", y2: "17"}),
            React.createElement('line', {x1: "14", y1: "11", x2: "14", y2: "17"})
        );

        const Edit = (props) => React.createElement('svg', {
            width: props.size || 20, height: props.size || 20, viewBox: "0 0 24 24", 
            fill: "none", stroke: "currentColor", strokeWidth: "2", 
            strokeLinecap: "round", strokeLinejoin: "round", className: props.className
        }, 
            React.createElement('path', {d: "M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),
            React.createElement('path', {d: "M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})
        );

        const BeautySalonApp = () => {
          // localStorage使用不可のため、React stateのみを使用
          const [selectedCustomer, setSelectedCustomer] = useState(null);
          const [customers, setCustomers] = useState([
            // サンプルデータ
            {
              id: 1,
              name: '田中 花子',
              nameKana: 'たなか はなこ',
              phone: '090-1234-5678',
              birthDate: '1990-05-15',
              lastVisit: '2024-11-20',
              preferences: {
                allergies: 'なし',
                hairType: '普通毛',
                notes: '肩こりがひどい、優しいマッサージ希望'
              },
              records: [
                {
                  id: 1,
                  date: '2024-11-20',
                  service: 'カット & カラー',
                  products: ['ロレアル カラー剤', 'トリートメント'],
                  style: 'ショートボブ',
                  duration: 120,
                  price: 8500,
                  notes: '根元のプリンが気になるとのこと。少し明るめに。次回は3ヶ月後を予定。'
                }
              ]
            }
          ]);
          const [searchTerm, setSearchTerm] = useState('');
          const [isEditing, setIsEditing] = useState(false);
          const [isAddingCustomer, setIsAddingCustomer] = useState(false);
          const [editingRecord, setEditingRecord] = useState(null);
          const [isEditingCustomer, setIsEditingCustomer] = useState(false);
          const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);

          const searchInputRef = useRef(null);

          const [newRecord, setNewRecord] = useState({
            date: new Date().toISOString().split('T')[0],
            service: '',
            products: [],
            style: '',
            duration: '',
            price: '',
            notes: ''
          });

          const [newCustomer, setNewCustomer] = useState({
            name: '',
            nameKana: '',
            phone: '',
            birthDate: '',
            preferences: {
              allergies: '',
              hairType: '',
              notes: ''
            }
          });

          const services = ['カット', 'カラー', 'パーマ', 'トリートメント', 'カット & カラー', 'カット & パーマ', 'ヘッドスパ'];
          const hairTypes = ['普通毛', '軟毛・細毛', '硬毛・太毛', 'くせ毛', '直毛'];

          // 時間オプション生成
          const timeOptions = [];
          for (let i = 15; i <= 600; i += 15) {
            const hours = Math.floor(i / 60);
            const minutes = i % 60;
            const label = hours > 0 
              ? (minutes > 0 ? `${hours}時間${minutes}分` : `${hours}時間`)
              : `${minutes}分`;
            timeOptions.push({ value: i, label });
          }

          // キーボードショートカット対応
          useEffect(() => {
            const handleKeyDown = (e) => {
              if ((e.metaKey || e.ctrlKey) && e.key === 'f') {
                e.preventDefault();
                if (searchInputRef.current) searchInputRef.current.focus();
              }
              
              if ((e.metaKey || e.ctrlKey) && e.key === 'n') {
                e.preventDefault();
                if (selectedCustomer) {
                  setIsEditing(true);
                } else {
                  setIsAddingCustomer(true);
                }
              }
              
              if (e.key === 'Escape') {
                setIsEditing(false);
                setIsAddingCustomer(false);
                setEditingRecord(null);
                setIsEditingCustomer(false);
                setShowDeleteConfirm(false);
              }
              
              if ((e.metaKey || e.ctrlKey) && e.key === 'Backspace' && selectedCustomer) {
                e.preventDefault();
                setSelectedCustomer(null);
              }
            };

            document.addEventListener('keydown', handleKeyDown);
            return () => document.removeEventListener('keydown', handleKeyDown);
          }, [selectedCustomer]);

          const formatNameWithSama = (name) => {
            return name ? `${name} 様` : '';
          };

          const formatPhoneNumber = (value) => {
            const numbers = value.replace(/\D/g, '');
            if (numbers.length <= 11) {
              if (numbers.length <= 3) {
                return numbers;
              } else if (numbers.length <= 7) {
                return `${numbers.slice(0, 3)}-${numbers.slice(3)}`;
              } else {
                return `${numbers.slice(0, 3)}-${numbers.slice(3, 7)}-${numbers.slice(7, 11)}`;
              }
            }
            return value;
          };

          const filteredCustomers = useMemo(() => {
            if (!searchTerm) {
              return customers.slice().sort((a, b) => (a.nameKana || a.name).localeCompare(b.nameKana || b.name, 'ja-JP'));
            }
            
            return customers
              .filter(customer =>
                customer.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                (customer.nameKana && customer.nameKana.includes(searchTerm)) ||
                customer.phone.includes(searchTerm)
              )
              .sort((a, b) => (a.nameKana || a.name).localeCompare(b.nameKana || b.name, 'ja-JP'));
          }, [customers, searchTerm]);

          const handleSearchChange = useCallback((e) => {
            setSearchTerm(e.target.value);
          }, []);

          const addNewRecord = useCallback(() => {
            if (!selectedCustomer) return;
            
            const record = {
              ...newRecord,
              id: Date.now(),
              products: newRecord.products.filter(p => p.trim())
            };
            
            const updatedCustomers = customers.map(customer => 
              customer.id === selectedCustomer.id 
                ? { ...customer, records: [record, ...(customer.records || [])], lastVisit: record.date }
                : customer
            );
            
            setCustomers(updatedCustomers);
            setSelectedCustomer(prev => ({ 
              ...prev, 
              records: [record, ...(prev.records || [])], 
              lastVisit: record.date 
            }));
            
            setNewRecord({
              date: new Date().toISOString().split('T')[0],
              service: '',
              products: [],
              style: '',
              duration: '',
              price: '',
              notes: ''
            });
            setIsEditing(false);
          }, [selectedCustomer, newRecord, customers]);

          const updateRecord = useCallback(() => {
            if (!selectedCustomer || !editingRecord) return;
            
            const updatedRecord = {
              ...editingRecord,
              products: editingRecord.products.filter(p => p.trim())
            };
            
            const updatedCustomers = customers.map(customer => 
              customer.id === selectedCustomer.id 
                ? { 
                    ...customer, 
                    records: customer.records.map(record => 
                      record.id === editingRecord.id ? updatedRecord : record
                    ),
                    lastVisit: customer.records.find(r => r.id === editingRecord.id)?.date === customer.lastVisit 
                      ? updatedRecord.date 
                      : customer.lastVisit
                  }
                : customer
            );
            
            setCustomers(updatedCustomers);
            setSelectedCustomer(prev => ({ 
              ...prev, 
              records: prev.records.map(record => 
                record.id === editingRecord.id ? updatedRecord : record
              )
            }));
            
            setEditingRecord(null);
          }, [selectedCustomer, editingRecord, customers]);

          const startEditRecord = useCallback((record) => {
            setEditingRecord({...record});
          }, []);

          const updateCustomer = useCallback(() => {
            if (!selectedCustomer || !isEditingCustomer) return;
            
            const updatedCustomers = customers.map(customer => 
              customer.id === selectedCustomer.id 
                ? { ...customer, ...selectedCustomer }
                : customer
            );
            
            setCustomers(updatedCustomers);
            setIsEditingCustomer(false);
          }, [selectedCustomer, customers, isEditingCustomer]);

          const deleteCustomer = useCallback(() => {
            if (!selectedCustomer) return;
            
            const updatedCustomers = customers.filter(customer => customer.id !== selectedCustomer.id);
            setCustomers(updatedCustomers);
            setSelectedCustomer(null);
            setShowDeleteConfirm(false);
          }, [selectedCustomer, customers]);

          const addNewCustomer = useCallback(() => {
            const customer = {
              ...newCustomer,
              id: Date.now(),
              lastVisit: '',
              records: []
            };
            
            setCustomers(prev => [...prev, customer]);
            setNewCustomer({
              name: '',
              nameKana: '',
              phone: '',
              birthDate: '',
              preferences: {
                allergies: '',
                hairType: '',
                notes: ''
              }
            });
            setIsAddingCustomer(false);
          }, [newCustomer]);

          const handlePhoneChange = useCallback((value, setter) => {
            const formatted = formatPhoneNumber(value);
            setter(prev => ({ ...prev, phone: formatted }));
          }, []);

          // お客様詳細画面
          if (selectedCustomer) {
            return React.createElement('div', {
              className: "min-h-screen bg-gray-100 safe-area-top safe-area-bottom"
            },
              React.createElement('div', { className: "flex h-screen flex-col" },
                React.createElement('div', { className: "flex-1 bg-white overflow-hidden" },
                  // ヘッダー
                  React.createElement('div', { className: "p-4 md:p-6 border-b border-gray-200 bg-white/90 backdrop-blur-sm sticky top-0 z-40" },
                    React.createElement('div', { className: "flex items-center justify-between mb-4" },
                      React.createElement('div', { className: "flex items-center gap-3 md:gap-4" },
                        React.createElement('button', {
                          onClick: () => setSelectedCustomer(null),
                          className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px]"
                        }, React.createElement(ChevronLeft, { size: 20 })),
                        React.createElement('div', {},
                          React.createElement('h1', { className: "text-xl md:text-2xl font-bold text-gray-900" }, formatNameWithSama(selectedCustomer.name)),
                          React.createElement('span', { className: "text-base md:text-lg text-gray-600 font-medium" }, selectedCustomer.phone)
                        )
                      ),
                      React.createElement('div', { className: "flex items-center gap-2" },
                        React.createElement('button', {
                          onClick: () => setIsEditingCustomer(true),
                          className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px] text-gray-600 hover:text-blue-600"
                        }, React.createElement(Edit, { size: 20 })),
                        React.createElement('button', {
                          onClick: () => setShowDeleteConfirm(true),
                          className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px] text-gray-600 hover:text-red-600"
                        }, React.createElement(Trash2, { size: 20 })),
                        React.createElement('button', {
                          onClick: () => setIsEditing(true),
                          className: "flex items-center gap-2 bg-green-600 text-white px-3 md:px-4 py-3 rounded-lg hover:bg-green-700 touch-manipulation text-sm md:text-base min-h-[48px]"
                        },
                          React.createElement(Plus, { size: 20 }),
                          React.createElement('span', { className: "hidden sm:inline" }, "新規記録"),
                          React.createElement('span', { className: "sm:hidden" }, "記録")
                        )
                      )
                    ),
                    React.createElement('div', { className: "mt-2 text-xs text-gray-500 hidden lg:block" },
                      "⌘F: 検索 | ⌘N: 新規記録 | ⌘⌫: 戻る | ESC: 閉じる | ✏️: 編集 | 🗑️: 削除"
                    )
                  ),

                  // コンテンツ
                  React.createElement('div', { className: "p-4 md:p-6 overflow-auto flex-1" },
                    React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6" },
                      // お客様情報
                      React.createElement('div', { className: "lg:col-span-1" },
                        React.createElement('div', { className: "bg-gray-50 rounded-lg p-4 mb-6" },
                          React.createElement('h2', { className: "text-lg font-semibold mb-4" }, "お客様情報"),
                          React.createElement('div', { className: "space-y-3 text-sm md:text-base" },
                            React.createElement('p', {},
                              React.createElement('span', { className: "font-medium" }, "生年月日: "), selectedCustomer.birthDate || '未設定'
                            ),
                            React.createElement('p', {},
                              React.createElement('span', { className: "font-medium" }, "最終来店: "), selectedCustomer.lastVisit || '未来店'
                            )
                          )
                        ),
                        React.createElement('div', { className: "bg-gray-50 rounded-lg p-4" },
                          React.createElement('h2', { className: "text-lg font-semibold mb-4" }, "お客様の特徴・希望"),
                          React.createElement('div', { className: "space-y-3 text-sm md:text-base" },
                            React.createElement('p', {},
                              React.createElement('span', { className: "font-medium" }, "アレルギー: "), selectedCustomer.preferences.allergies || 'なし'
                            ),
                            React.createElement('p', {},
                              React.createElement('span', { className: "font-medium" }, "髪質: "), selectedCustomer.preferences.hairType || '未設定'
                            ),
                            React.createElement('p', {},
                              React.createElement('span', { className: "font-medium" }, "特記事項: "), selectedCustomer.preferences.notes || 'なし'
                            )
                          )
                        )
                      ),

                      // 施術履歴
                      React.createElement('div', { className: "lg:col-span-2" },
                        React.createElement('h2', { className: "text-lg font-semibold mb-4" }, "施術履歴"),
                        selectedCustomer.records && selectedCustomer.records.length > 0 ? 
                          React.createElement('div', { className: "space-y-4" },
                            selectedCustomer.records.map(record =>
                              React.createElement('div', { key: record.id, className: "border border-gray-200 rounded-lg p-4" },
                                React.createElement('div', { className: "flex flex-col sm:flex-row sm:items-center justify-between mb-3 gap-3" },
                                  React.createElement('div', { className: "flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4" },
                                    React.createElement('div', { className: "flex items-center gap-2" },
                                      React.createElement(Calendar, { size: 16, className: "text-gray-500" }),
                                      React.createElement('span', { className: "font-medium text-sm md:text-base" }, record.date)
                                    ),
                                    React.createElement('div', { className: "flex items-center gap-2" },
                                      React.createElement(Scissors, { size: 16, className: "text-gray-500" }),
                                      React.createElement('span', { className: "text-sm md:text-base" }, record.service)
                                    )
                                  ),
                                  React.createElement('div', { className: "flex items-center gap-2" },
                                    React.createElement('span', { className: "text-lg font-semibold text-green-600" }, `¥${record.price.toLocaleString()}`),
                                    React.createElement('button', {
                                      onClick: () => startEditRecord(record),
                                      className: "p-2 hover:bg-gray-100 rounded-lg touch-manipulation text-gray-600 hover:text-blue-600"
                                    }, React.createElement(Edit, { size: 16 }))
                                  )
                                ),
                                
                                React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 text-sm md:text-base" },
                                  React.createElement('p', {},
                                    React.createElement('span', { className: "font-medium" }, "スタイル: "), record.style
                                  ),
                                  React.createElement('p', {},
                                    React.createElement('span', { className: "font-medium" }, "施術時間: "), record.duration, "分"
                                  )
                                ),

                                record.products && record.products.length > 0 && React.createElement('div', { className: "mb-3" },
                                  React.createElement('p', { className: "font-medium text-sm md:text-base mb-2" }, "使用薬品:"),
                                  React.createElement('div', { className: "flex flex-wrap gap-2" },
                                    record.products.map((product, index) =>
                                      React.createElement('span', {
                                        key: index,
                                        className: "bg-blue-100 text-blue-800 text-xs md:text-sm px-2 py-1 rounded"
                                      }, product)
                                    )
                                  )
                                ),

                                React.createElement('div', { className: "bg-gray-50 rounded p-3" },
                                  React.createElement('p', { className: "font-medium text-sm md:text-base mb-1" }, "施術メモ:"),
                                  React.createElement('p', { className: "text-sm md:text-base text-gray-700" }, record.notes)
                                )
                              )
                            )
                          ) :
                          React.createElement('div', { className: "text-center py-8 text-gray-500" },
                            React.createElement('p', {}, "まだ施術履歴がありません"),
                            React.createElement('p', { className: "text-sm" }, "新規記録ボタンから追加してください")
                          )
                      )
                    )
                  )
                )
              ),

              // お客様情報編集モーダル
              isEditingCustomer && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50" },
                React.createElement('div', { className: "bg-white rounded-lg p-4 md:p-6 w-full max-w-2xl my-4 shadow-2xl modal-content" },
                  React.createElement('div', { className: "flex items-center justify-between mb-6" },
                    React.createElement('h2', { className: "text-lg md:text-xl font-bold" }, `お客様情報編集 - ${formatNameWithSama(selectedCustomer.name)}`),
                    React.createElement('button', {
                      onClick: () => setIsEditingCustomer(false),
                      className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px]"
                    }, React.createElement(X, { size: 24 }))
                  ),

                  React.createElement('div', { className: "space-y-4" },
                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "お名前 *"),
                      React.createElement('input', {
                        type: "text",
                        value: selectedCustomer.name,
                        onChange: (e) => setSelectedCustomer({...selectedCustomer, name: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                        placeholder: "田中 花子"
                      })
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "お名前（ひらがな） *"),
                      React.createElement('input', {
                        type: "text",
                        value: selectedCustomer.nameKana,
                        onChange: (e) => setSelectedCustomer({...selectedCustomer, nameKana: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                        placeholder: "たなか はなこ"
                      })
                    ),

                    React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "電話番号 *"),
                        React.createElement('input', {
                          type: "tel",
                          value: selectedCustomer.phone,
                          onChange: (e) => setSelectedCustomer({...selectedCustomer, phone: formatPhoneNumber(e.target.value)}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                          placeholder: "090-1234-5678"
                        })
                      ),
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "生年月日"),
                        React.createElement('input', {
                          type: "date",
                          value: selectedCustomer.birthDate,
                          onChange: (e) => setSelectedCustomer({...selectedCustomer, birthDate: e.target.value}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                        })
                      )
                    ),

                    React.createElement('div', { className: "border-t pt-4" },
                      React.createElement('h3', { className: "text-lg font-semibold mb-4" }, "お客様の特徴・希望"),
                      
                      React.createElement('div', { className: "space-y-4" },
                        React.createElement('div', {},
                          React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "アレルギー"),
                          React.createElement('input', {
                            type: "text",
                            value: selectedCustomer.preferences.allergies,
                            onChange: (e) => setSelectedCustomer({
                              ...selectedCustomer, 
                              preferences: {...selectedCustomer.preferences, allergies: e.target.value}
                            }),
                            className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                            placeholder: "なし / 特定の成分名など"
                          })
                        ),

                        React.createElement('div', {},
                          React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "髪質"),
                          React.createElement('select', {
                            value: selectedCustomer.preferences.hairType,
                            onChange: (e) => setSelectedCustomer({
                              ...selectedCustomer, 
                              preferences: {...selectedCustomer.preferences, hairType: e.target.value}
                            }),
                            className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                          },
                            React.createElement('option', { value: "" }, "選択してください"),
                            hairTypes.map(type =>
                              React.createElement('option', { key: type, value: type }, type)
                            )
                          )
                        ),

                        React.createElement('div', {},
                          React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "特記事項"),
                          React.createElement('textarea', {
                            value: selectedCustomer.preferences.notes,
                            onChange: (e) => setSelectedCustomer({
                              ...selectedCustomer, 
                              preferences: {...selectedCustomer.preferences, notes: e.target.value}
                            }),
                            className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-20 touch-manipulation resize-none ios-input",
                            placeholder: "肩こり、スタイリング希望、その他注意事項など..."
                          })
                        )
                      )
                    )
                  ),

                  React.createElement('div', { className: "flex flex-col sm:flex-row gap-4 mt-6" },
                    React.createElement('button', {
                      onClick: () => setIsEditingCustomer(false),
                      className: "flex-1 py-4 text-base border border-gray-300 rounded-lg hover:bg-gray-50 touch-manipulation min-h-[48px]"
                    }, "キャンセル"),
                    React.createElement('button', {
                      onClick: updateCustomer,
                      disabled: !selectedCustomer.name || !selectedCustomer.nameKana || !selectedCustomer.phone,
                      className: "flex-1 bg-orange-600 text-white py-4 text-base rounded-lg hover:bg-orange-700 flex items-center justify-center gap-2 touch-manipulation min-h-[48px] disabled:bg-gray-400 disabled:cursor-not-allowed"
                    },
                      React.createElement(Save, { size: 20 }),
                      "更新"
                    )
                  )
                )
              ),

              // 削除確認モーダル
              showDeleteConfirm && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" },
                React.createElement('div', { className: "bg-white rounded-lg p-6 w-full max-w-md shadow-2xl" },
                  React.createElement('div', { className: "flex items-center justify-between mb-4" },
                    React.createElement('h3', { className: "text-lg font-bold text-red-600" }, "削除確認"),
                    React.createElement('button', {
                      onClick: () => setShowDeleteConfirm(false),
                      className: "p-2 hover:bg-gray-100 rounded-lg touch-manipulation"
                    }, React.createElement(X, { size: 20 }))
                  ),
                  
                  React.createElement('div', { className: "mb-6" },
                    React.createElement('p', { className: "text-gray-700 mb-2" }, 
                      `${formatNameWithSama(selectedCustomer.name)}の情報を完全に削除しますか？`
                    ),
                    React.createElement('p', { className: "text-sm text-red-600" }, 
                      "※ この操作は取り消せません。すべての施術履歴も削除されます。"
                    )
                  ),

                  React.createElement('div', { className: "flex gap-4" },
                    React.createElement('button', {
                      onClick: () => setShowDeleteConfirm(false),
                      className: "flex-1 py-3 text-base border border-gray-300 rounded-lg hover:bg-gray-50 touch-manipulation"
                    }, "キャンセル"),
                    React.createElement('button', {
                      onClick: deleteCustomer,
                      className: "flex-1 bg-red-600 text-white py-3 text-base rounded-lg hover:bg-red-700 flex items-center justify-center gap-2 touch-manipulation"
                    },
                      React.createElement(Trash2, { size: 18 }),
                      "削除"
                    )
                  )
                )
              ),

              // 新規記録モーダル
              isEditing && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50" },
                React.createElement('div', { className: "bg-white rounded-lg p-4 md:p-6 w-full max-w-2xl my-4 shadow-2xl modal-content" },
                  React.createElement('div', { className: "flex items-center justify-between mb-6" },
                    React.createElement('h2', { className: "text-lg md:text-xl font-bold" }, `新規施術記録 - ${formatNameWithSama(selectedCustomer.name)}`),
                    React.createElement('button', {
                      onClick: () => setIsEditing(false),
                      className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px]"
                    }, React.createElement(X, { size: 24 }))
                  ),

                  React.createElement('div', { className: "space-y-4" },
                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術日"),
                      React.createElement('input', {
                        type: "date",
                        value: newRecord.date,
                        onChange: (e) => setNewRecord({...newRecord, date: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                      })
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術内容"),
                      React.createElement('select', {
                        value: newRecord.service,
                        onChange: (e) => setNewRecord({...newRecord, service: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                      },
                        React.createElement('option', { value: "" }, "選択してください"),
                        services.map(service =>
                          React.createElement('option', { key: service, value: service }, service)
                        )
                      )
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "スタイル"),
                      React.createElement('input', {
                        type: "text",
                        value: newRecord.style,
                        onChange: (e) => setNewRecord({...newRecord, style: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                        placeholder: "ショートボブ、レイヤーカット等"
                      })
                    ),

                    React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術時間"),
                        React.createElement('select', {
                          value: newRecord.duration,
                          onChange: (e) => setNewRecord({...newRecord, duration: parseInt(e.target.value) || ''}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                        },
                          React.createElement('option', { value: "" }, "選択してください"),
                          timeOptions.map(option =>
                            React.createElement('option', { key: option.value, value: option.value }, option.label)
                          )
                        )
                      ),
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "料金（円）"),
                        React.createElement('input', {
                          type: "number",
                          value: newRecord.price,
                          onChange: (e) => setNewRecord({...newRecord, price: parseInt(e.target.value) || ''}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                          placeholder: "8500"
                        })
                      )
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "使用薬品（1行に1つずつ）"),
                      React.createElement('textarea', {
                        value: newRecord.products.join('\n'),
                        onChange: (e) => setNewRecord({...newRecord, products: e.target.value.split('\n')}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-24 touch-manipulation resize-none ios-input",
                        placeholder: "ロレアル カラー剤\nトリートメント"
                      })
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術メモ"),
                      React.createElement('textarea', {
                        value: newRecord.notes,
                        onChange: (e) => setNewRecord({...newRecord, notes: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-32 touch-manipulation resize-none ios-input",
                        placeholder: "お客様の要望、施術内容の詳細等"
                      })
                    )
                  ),

                  React.createElement('div', { className: "flex flex-col sm:flex-row gap-4 mt-6" },
                    React.createElement('button', {
                      onClick: () => setIsEditing(false),
                      className: "flex-1 py-4 text-base border border-gray-300 rounded-lg hover:bg-gray-50 touch-manipulation min-h-[48px]"
                    }, "キャンセル"),
                    React.createElement('button', {
                      onClick: addNewRecord,
                      disabled: !newRecord.service || !newRecord.price,
                      className: "flex-1 bg-blue-600 text-white py-4 text-base rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 touch-manipulation min-h-[48px] disabled:bg-gray-400 disabled:cursor-not-allowed"
                    },
                      React.createElement(Save, { size: 20 }),
                      "保存"
                    )
                  )
                )
              ),

              // 施術履歴編集モーダル
              editingRecord && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50" },
                React.createElement('div', { className: "bg-white rounded-lg p-4 md:p-6 w-full max-w-2xl my-4 shadow-2xl modal-content" },
                  React.createElement('div', { className: "flex items-center justify-between mb-6" },
                    React.createElement('h2', { className: "text-lg md:text-xl font-bold" }, `施術記録編集 - ${formatNameWithSama(selectedCustomer.name)}`),
                    React.createElement('button', {
                      onClick: () => setEditingRecord(null),
                      className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px]"
                    }, React.createElement(X, { size: 24 }))
                  ),

                  React.createElement('div', { className: "space-y-4" },
                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術日"),
                      React.createElement('input', {
                        type: "date",
                        value: editingRecord.date,
                        onChange: (e) => setEditingRecord({...editingRecord, date: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                      })
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術内容"),
                      React.createElement('select', {
                        value: editingRecord.service,
                        onChange: (e) => setEditingRecord({...editingRecord, service: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                      },
                        React.createElement('option', { value: "" }, "選択してください"),
                        services.map(service =>
                          React.createElement('option', { key: service, value: service }, service)
                        )
                      )
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "スタイル"),
                      React.createElement('input', {
                        type: "text",
                        value: editingRecord.style,
                        onChange: (e) => setEditingRecord({...editingRecord, style: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                        placeholder: "ショートボブ、レイヤーカット等"
                      })
                    ),

                    React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術時間"),
                        React.createElement('select', {
                          value: editingRecord.duration,
                          onChange: (e) => setEditingRecord({...editingRecord, duration: parseInt(e.target.value) || ''}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                        },
                          React.createElement('option', { value: "" }, "選択してください"),
                          timeOptions.map(option =>
                            React.createElement('option', { key: option.value, value: option.value }, option.label)
                          )
                        )
                      ),
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "料金（円）"),
                        React.createElement('input', {
                          type: "number",
                          value: editingRecord.price,
                          onChange: (e) => setEditingRecord({...editingRecord, price: parseInt(e.target.value) || ''}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                          placeholder: "8500"
                        })
                      )
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "使用薬品（1行に1つずつ）"),
                      React.createElement('textarea', {
                        value: editingRecord.products.join('\n'),
                        onChange: (e) => setEditingRecord({...editingRecord, products: e.target.value.split('\n')}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-24 touch-manipulation resize-none ios-input",
                        placeholder: "ロレアル カラー剤\nトリートメント"
                      })
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術メモ"),
                      React.createElement('textarea', {
                        value: editingRecord.notes,
                        onChange: (e) => setEditingRecord({...editingRecord, notes: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-32 touch-manipulation resize-none ios-input",
                        placeholder: "お客様の要望、施術内容の詳細等"
                      })
                    )
                  ),

                  React.createElement('div', { className: "flex flex-col sm:flex-row gap-4 mt-6" },
                    React.createElement('button', {
                      onClick: () => setEditingRecord(null),
                      className: "flex-1 py-4 text-base border border-gray-300 rounded-lg hover:bg-gray-50 touch-manipulation min-h-[48px]"
                    }, "キャンセル"),
                    React.createElement('button', {
                      onClick: updateRecord,
                      disabled: !editingRecord.service || !editingRecord.price,
                      className: "flex-1 bg-orange-600 text-white py-4 text-base rounded-lg hover:bg-orange-700 flex items-center justify-center gap-2 touch-manipulation min-h-[48px] disabled:bg-gray-400 disabled:cursor-not-allowed"
                    },
                      React.createElement(Save, { size: 20 }),
                      "更新"
                    )
                  )
                )
              )
                          React.createElement('option', { key: service, value: service }, service)
                        )
                      )
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "スタイル"),
                      React.createElement('input', {
                        type: "text",
                        value: newRecord.style,
                        onChange: (e) => setNewRecord({...newRecord, style: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                        placeholder: "ショートボブ、レイヤーカット等"
                      })
                    ),

                    React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術時間"),
                        React.createElement('select', {
                          value: newRecord.duration,
                          onChange: (e) => setNewRecord({...newRecord, duration: parseInt(e.target.value) || ''}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                        },
                          React.createElement('option', { value: "" }, "選択してください"),
                          timeOptions.map(option =>
                            React.createElement('option', { key: option.value, value: option.value }, option.label)
                          )
                        )
                      ),
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "料金（円）"),
                        React.createElement('input', {
                          type: "number",
                          value: newRecord.price,
                          onChange: (e) => setNewRecord({...newRecord, price: parseInt(e.target.value) || ''}),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                          placeholder: "8500"
                        })
                      )
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "使用薬品（1行に1つずつ）"),
                      React.createElement('textarea', {
                        value: newRecord.products.join('\n'),
                        onChange: (e) => setNewRecord({...newRecord, products: e.target.value.split('\n')}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-24 touch-manipulation resize-none ios-input",
                        placeholder: "ロレアル カラー剤\nトリートメント"
                      })
                    ),

                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "施術メモ"),
                      React.createElement('textarea', {
                        value: newRecord.notes,
                        onChange: (e) => setNewRecord({...newRecord, notes: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-32 touch-manipulation resize-none ios-input",
                        placeholder: "お客様の要望、施術内容の詳細等"
                      })
                    )
                  ),

                  React.createElement('div', { className: "flex flex-col sm:flex-row gap-4 mt-6" },
                    React.createElement('button', {
                      onClick: () => setIsEditing(false),
                      className: "flex-1 py-4 text-base border border-gray-300 rounded-lg hover:bg-gray-50 touch-manipulation min-h-[48px]"
                    }, "キャンセル"),
                    React.createElement('button', {
                      onClick: addNewRecord,
                      disabled: !newRecord.service || !newRecord.price,
                      className: "flex-1 bg-blue-600 text-white py-4 text-base rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 touch-manipulation min-h-[48px] disabled:bg-gray-400 disabled:cursor-not-allowed"
                    },
                      React.createElement(Save, { size: 20 }),
                      "保存"
                    )
                  )
                )
              )
            );
          }

          // お客様一覧画面
          return React.createElement('div', {
            className: "min-h-screen bg-gray-100 safe-area-top safe-area-bottom"
          },
            React.createElement('div', { className: "flex h-screen flex-col" },
              React.createElement('div', { className: "flex-1 bg-white overflow-hidden" },
                React.createElement('div', { className: "p-4 md:p-6 border-b border-gray-200" },
                  React.createElement('div', { className: "flex items-center justify-between mb-4" },
                    React.createElement('h1', { className: "text-xl md:text-2xl font-bold text-gray-900" }, "お客様情報"),
                    React.createElement('button', {
                      className: "flex items-center gap-2 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 touch-manipulation min-h-[48px]",
                      onClick: () => setIsAddingCustomer(true)
                    },
                      React.createElement(Plus, { size: 20 }),
                      "新規"
                    )
                  ),
                  React.createElement('div', { className: "relative" },
                    React.createElement(Search, { className: "absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none", size: 20 }),
                    React.createElement('input', {
                      ref: searchInputRef,
                      type: "text",
                      placeholder: "お客様名（ひらがな）、電話番号で検索...",
                      className: "w-full pl-10 pr-4 py-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none touch-manipulation min-h-[48px] ios-input",
                      value: searchTerm,
                      onChange: handleSearchChange,
                      autoComplete: "off",
                      autoCorrect: "off",
                      spellCheck: "false"
                    })
                  )
                ),
                
                React.createElement('div', { className: "overflow-auto flex-1" },
                  filteredCustomers.length > 0 ? 
                    filteredCustomers.map(customer =>
                      React.createElement('div', {
                        key: customer.id,
                        className: "p-4 md:p-6 border-b border-gray-100 hover:bg-gray-50 cursor-pointer touch-manipulation active:bg-gray-100",
                        onClick: () => setSelectedCustomer(customer)
                      },
                        React.createElement('div', { className: "flex items-center justify-between" },
                          React.createElement('div', { className: "flex items-center gap-4" },
                            React.createElement('div', { className: "w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center" },
                              React.createElement(User, { className: "text-blue-600", size: 24 })
                            ),
                            React.createElement('div', {},
                              React.createElement('div', { className: "flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3" },
                                React.createElement('h3', { className: "font-semibold text-base md:text-lg text-gray-900" }, formatNameWithSama(customer.name)),
                                React.createElement('span', { className: "text-sm md:text-base text-gray-600 font-medium" }, customer.phone)
                              ),
                              React.createElement('p', { className: "text-sm text-gray-500" }, `最終来店: ${customer.lastVisit || '未来店'}`)
                            )
                          ),
                          React.createElement(ChevronRight, { className: "text-gray-400", size: 20 })
                        )
                      )
                    ) :
                    React.createElement('div', { className: "flex flex-col items-center justify-center py-12 text-gray-500" },
                      React.createElement(User, { size: 48, className: "mb-4" }),
                      React.createElement('p', { className: "text-lg mb-2" }, "お客様が登録されていません"),
                      React.createElement('p', { className: "text-sm" }, "新規ボタンからお客様を追加してください")
                    )
                )
              )
            ),
            
            // 新規お客様追加モーダル
            isAddingCustomer && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50" },
              React.createElement('div', { className: "bg-white rounded-lg p-4 md:p-6 w-full max-w-2xl my-4 shadow-2xl modal-content" },
                React.createElement('div', { className: "flex items-center justify-between mb-6" },
                  React.createElement('h2', { className: "text-lg md:text-xl font-bold" }, "新規お客様登録"),
                  React.createElement('button', {
                    onClick: () => setIsAddingCustomer(false),
                    className: "p-3 hover:bg-gray-100 rounded-lg touch-manipulation min-h-[48px] min-w-[48px]"
                  }, React.createElement(X, { size: 24 }))
                ),

                React.createElement('div', { className: "space-y-4" },
                  React.createElement('div', {},
                    React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "お名前 *"),
                    React.createElement('input', {
                      type: "text",
                      value: newCustomer.name,
                      onChange: (e) => setNewCustomer({...newCustomer, name: e.target.value}),
                      className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                      placeholder: "田中 花子"
                    })
                  ),

                  React.createElement('div', {},
                    React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "お名前（ひらがな） *"),
                    React.createElement('input', {
                      type: "text",
                      value: newCustomer.nameKana,
                      onChange: (e) => setNewCustomer({...newCustomer, nameKana: e.target.value}),
                      className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                      placeholder: "たなか はなこ"
                    })
                  ),

                  React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "電話番号 *"),
                      React.createElement('input', {
                        type: "tel",
                        value: newCustomer.phone,
                        onChange: (e) => handlePhoneChange(e.target.value, setNewCustomer),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                        placeholder: "090-1234-5678"
                      })
                    ),
                    React.createElement('div', {},
                      React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "生年月日"),
                      React.createElement('input', {
                        type: "date",
                        value: newCustomer.birthDate,
                        onChange: (e) => setNewCustomer({...newCustomer, birthDate: e.target.value}),
                        className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                      })
                    )
                  ),

                  React.createElement('div', { className: "border-t pt-4" },
                    React.createElement('h3', { className: "text-lg font-semibold mb-4" }, "お客様の特徴・希望"),
                    
                    React.createElement('div', { className: "space-y-4" },
                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "アレルギー"),
                        React.createElement('input', {
                          type: "text",
                          value: newCustomer.preferences.allergies,
                          onChange: (e) => setNewCustomer({
                            ...newCustomer, 
                            preferences: {...newCustomer.preferences, allergies: e.target.value}
                          }),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input",
                          placeholder: "なし / 特定の成分名など"
                        })
                      ),

                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "髪質"),
                        React.createElement('select', {
                          value: newCustomer.preferences.hairType,
                          onChange: (e) => setNewCustomer({
                            ...newCustomer, 
                            preferences: {...newCustomer.preferences, hairType: e.target.value}
                          }),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 touch-manipulation min-h-[48px] ios-input"
                        },
                          React.createElement('option', { value: "" }, "選択してください"),
                          hairTypes.map(type =>
                            React.createElement('option', { key: type, value: type }, type)
                          )
                        )
                      ),

                      React.createElement('div', {},
                        React.createElement('label', { className: "block text-sm md:text-base font-medium mb-2" }, "特記事項"),
                        React.createElement('textarea', {
                          value: newCustomer.preferences.notes,
                          onChange: (e) => setNewCustomer({
                            ...newCustomer, 
                            preferences: {...newCustomer.preferences, notes: e.target.value}
                          }),
                          className: "w-full p-4 text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 h-20 touch-manipulation resize-none ios-input",
                          placeholder: "肩こり、スタイリング希望、その他注意事項など..."
                        })
                      )
                    )
                  )
                ),

                React.createElement('div', { className: "flex flex-col sm:flex-row gap-4 mt-6" },
                  React.createElement('button', {
                    onClick: () => setIsAddingCustomer(false),
                    className: "flex-1 py-4 text-base border border-gray-300 rounded-lg hover:bg-gray-50 touch-manipulation min-h-[48px]"
                  }, "キャンセル"),
                  React.createElement('button', {
                    onClick: addNewCustomer,
                    disabled: !newCustomer.name || !newCustomer.nameKana || !newCustomer.phone,
                    className: "flex-1 bg-blue-600 text-white py-4 text-base rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 touch-manipulation min-h-[48px] disabled:bg-gray-400 disabled:cursor-not-allowed"
                  },
                    React.createElement(Save, { size: 20 }),
                    "登録"
                  )
                )
              )
            )
          );
        };

        // アプリを起動
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(BeautySalonApp));

        // ビューポート調整（iPadデバイス対応）
        function setVh() {
          const vh = window.innerHeight * 0.01;
          document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        
        setVh();
        window.addEventListener('resize', setVh);
        window.addEventListener('orientationchange', () => {
          setTimeout(setVh, 500);
        });

        // PWA対応
        if ('serviceWorker' in navigator) {
          window.addEventListener('load', () => {
            const swCode = `
              self.addEventListener('install', (event) => {
                console.log('Service Worker installed');
                self.skipWaiting();
              });
              
              self.addEventListener('activate', (event) => {
                console.log('Service Worker activated');
                event.waitUntil(clients.claim());
              });
            `;
            
            const blob = new Blob([swCode], { type: 'application/javascript' });
            const swUrl = URL.createObjectURL(blob);
            
            navigator.serviceWorker.register(swUrl)
              .then(registration => {
                console.log('Service Worker registered successfully');
              })
              .catch(error => {
                console.log('Service Worker registration failed:', error);
              });
          });
        }
    </script>
</body>
</html>